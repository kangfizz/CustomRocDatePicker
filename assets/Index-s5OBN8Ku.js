import{_ as R,c as u,o as r,r as q,n as B,a as s,b as L,d as de,w as z,e as I,v as ie,f as c,g as k,h as S,i as ue,j as G,F as x,k as F,l as p,m as _,p as re,q as ce,s as ve,t as y}from"./index-iG0kcbeF.js";const fe=["disabled"],pe={__name:"BaseButton",props:{customClass:{type:String,default:"icon-button"},disabled:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:n}){const g=n;return(m,$)=>(r(),u("button",{type:"button",class:B(`${e.customClass} ${e.disabled?"disabled":""}`),onClick:$[0]||($[0]=d=>e.disabled?void 0:g("click")),disabled:e.disabled},[q(m.$slots,"icon",{},void 0),q(m.$slots,"default",{},void 0)],10,fe))}},me=R(pe,[["__scopeId","data-v-5cae7ed8"]]),$e={},ge={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-calendar"};function he(e,n){return r(),u("svg",ge,n[0]||(n[0]=[s("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},null,-1),s("line",{x1:"16",y1:"2",x2:"16",y2:"6"},null,-1),s("line",{x1:"8",y1:"2",x2:"8",y2:"6"},null,-1),s("line",{x1:"3",y1:"10",x2:"21",y2:"10"},null,-1)]))}const ye=R($e,[["render",he]]),Ce={},ke={xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#1f1f1f"};function we(e,n){return r(),u("svg",ke,n[0]||(n[0]=[s("path",{d:"M560-240 320-480l240-240 56 56-184 184 184 184-56 56Z"},null,-1)]))}const be=R(Ce,[["render",we]]),De={},Ie={xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#1f1f1f"};function xe(e,n){return r(),u("svg",Ie,n[0]||(n[0]=[s("path",{d:"M504-480 320-664l56-56 240 240-240 240-56-56 184-184Z"},null,-1),L("\\ ")]))}const Me=R(De,[["render",xe]]),H=(e,n,g)=>{n=n-1;const m=new Date(e,n,g);return m.getFullYear()==e&&m.getMonth()==n&&m.getDate()==g},h=e=>("0"+e).slice(-2),Ye=de({name:"RocCustomDatePicker",components:{BaseButton:me,CalendarIcon:ye,ChevronLeftIcon:be,ChevronRightIcon:Me},props:{date:{type:String,default:""},placeholder:{type:String,default:"民國年/月/日"},splitter:{type:String,default:""},readonly:{type:Boolean,default:!1},needInput:{type:Boolean,default:!0},needFuture:{type:Boolean,default:!1},autoToRocFormat:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:date"],setup(e,{emit:n}){const g=/[\s/\-.]/,m=p(!0),$=p(!1),d=p(null),l=p(null),o=p(null),w=p([]),C=p("date"),M=p(null),a=p(Math.floor((new Date().getFullYear()-1911)/15)),f=p(null),j=["日","一","二","三","四","五","六"],Z=[{text:"一月",value:1},{text:"二月",value:2},{text:"三月",value:3},{text:"四月",value:4},{text:"五月",value:5},{text:"六月",value:6},{text:"七月",value:7},{text:"八月",value:8},{text:"九月",value:9},{text:"十月",value:10},{text:"十一月",value:11},{text:"十二月",value:12}],N=_({get:()=>e.date,set:t=>n("update:date",t)}),J=_(()=>{var t;return((t=Z.find(i=>i.value===l.value))==null?void 0:t.text)||""}),K=_(()=>parseInt(d.value)<=0?`民國前 ${Math.abs(d.value)+1} 年`:`民國 ${d.value} 年`),Q=_(()=>{const t=M.value*15;return Array.from({length:15},(v,D)=>t+D)}),W=_(()=>{const t=d.value,i=l.value;return!t||!i?0:new Date(t+1911,i-1,1).getDay()});re(()=>f.value,(t,i)=>{if(t!==i){const v=new Date(t).toString()!=="Invalid Date",D=b(t,!1),Y=A(t,D);if(N.value="",!v||!Y){V();return}d.value=Y[0],l.value=Y[1],o.value=Y[2];const O=e.splitter?e.splitter:D;v&&H(d.value+1911,l.value,o.value)&&(N.value=`${d.value+(e.autoToRocFormat?1911:0)}${O}${h(l.value)}${O}${h(o.value)}`)}});const T=()=>{if(w.value=[],d.value&&l.value){const t=d.value+1911,i=l.value,v=new Date(t,i,0).getDate();w.value=Array.from({length:v},(D,Y)=>Y+1)}},X=t=>{t==="minusYear"?d.value-=1:t==="plusYear"?d.value+=1:t==="minusMonth"?l.value>1?l.value-=1:(l.value=12,d.value-=1):t==="plusMonth"&&(l.value<12?l.value+=1:(l.value=1,d.value+=1)),T()},A=(t,i)=>{let v=[];return v=t.split(i),v.length!==3?null:v.map(D=>parseInt(D))},b=(t,i=!0)=>typeof t!="string"?"/":i&&e.splitter?e.splitter:t.match(g)?t.match(g)[0]:"/",ee=t=>{const i=b(f.value);return`${d.value}${i}${h(l.value)}${i}${h(t)}`===f.value},te=()=>{var v;const t=b(f.value),i=(v=f.value)==null?void 0:v.split(t);!i||i.length!==3||!H(parseInt(i[0])+1911,parseInt(i[1]),parseInt(i[2]))?V():(E(f.value),f.value=`${d.value}${t}${h(l.value)}${t}${h(o.value)}`),setTimeout(()=>{$.value?P():$.value=!0},50)},P=()=>{C.value="date",$.value=!1},le=t=>{C.value=t},ne=t=>{d.value=t,C.value="month",l.value=null},ae=t=>{l.value=t,C.value="date",o.value=null,T()},se=t=>{o.value=t,f.value=[d.value,h(l.value),h(o.value)].join(b(f.value)),$.value=!1},V=()=>{const t=new Date;d.value=t.getFullYear()-1911,l.value=t.getMonth()+1,o.value=null,M.value=Math.floor(d.value/15),setTimeout(()=>{T()},100)},E=(t,i=!1)=>{const v=t.split(b(t));d.value=i?parseInt(v[0])-1911:parseInt(v[0]),l.value=parseInt(v[1]),o.value=parseInt(v[2]),M.value=Math.floor(d.value/15),setTimeout(()=>{T()},100)},oe=(t,i)=>{if(e.needFuture)return!0;if(t==="year")return!(i>new Date().getFullYear()-1911);if(t==="month")return!(d.value>=new Date().getFullYear()-1911&&i>new Date().getMonth()+1);if(t==="date")return!(new Date(d.value+1911,l.value-1,i)>new Date)};return ce(()=>{if(e.date){E(e.date,e.autoToRocFormat);const t=b(e.date);f.value=`${d.value}${t}${h(l.value)}${t}${h(o.value)}`,m.value=!1}else V()}),ve(()=>{document.removeEventListener("click",P)}),{changeCalendar:X,changeCalendarType:le,checkIsSelectedDate:ee,displayedDate:f,displayedMonth:J,displayedYear:K,firstDayOfMonth:W,showCalendar:$,selectedYear:d,selectedMonth:l,selectedDay:o,calendarDays:w,months:Z,years:Q,toggleCalendar:te,closeCalendar:P,generateDayCalendar:T,selectDate:se,selectMonth:ae,selectYear:ne,selectedType:C,weekdays:j,myDate:N,yearRangeIndex:M,currentYearRangeIndex:a,canClick:oe,splitDate:A,getSplitter:b}}}),Be={class:"date-picker"},Re=["placeholder","readonly","disabled"],Te={key:0,class:"flex gap-x-4 items-center mb-6"},Fe={class:"flex gap-x-2 items-center"},_e={class:"whitespace-nowrap"},Le={class:"flex gap-x-2 items-center"},Se={class:"whitespace-nowrap"},Ue={key:1,class:"flex flex-nowrap gap-x-2 items-center"},je={class:"year-calendar"},Ne=["onClick"],Pe={key:2,class:"month-calendar"},Ve=["onClick"],Ze={key:0,class:"day-calendar"},Ae=["onClick"];function Ee(e,n,g,m,$,d){const l=S("CalendarIcon"),o=S("base-button"),w=S("ChevronLeftIcon"),C=S("ChevronRightIcon"),M=ue("click-outside");return r(),u("div",Be,[s("div",{class:B(`input-wrapper px-2 ${e.needInput?"border border-solid rounded-[5px] border-[#ccc]":""}`),onClick:n[11]||(n[11]=G(()=>{},["stop"]))},[e.needInput?z((r(),u("input",{key:0,type:"text","onUpdate:modelValue":n[0]||(n[0]=a=>e.displayedDate=a),placeholder:e.placeholder,class:B(`outline-none !border-hidden ${e.disabled?"disabled":""}`),readonly:e.readonly,disabled:e.disabled,onClick:n[1]||(n[1]=a=>e.readonly?e.toggleCalendar():void 0)},null,10,Re)),[[ie,e.displayedDate]]):I("",!0),s("div",null,[c(o,{disabled:e.disabled,onClick:e.toggleCalendar},{icon:k(()=>[c(l)]),_:1},8,["disabled","onClick"]),e.showCalendar?z((r(),u("div",{key:0,id:"customCalendar",class:"calendar",onClick:n[10]||(n[10]=G(()=>{},["stop"]))},[e.selectedType==="date"?(r(),u("div",Te,[s("div",Fe,[c(o,{onClick:n[2]||(n[2]=a=>e.changeCalendar("minusYear")),disabled:e.selectedYear===1},{icon:k(()=>[c(w)]),_:1},8,["disabled"]),c(o,{onClick:n[3]||(n[3]=a=>e.changeCalendarType("year"))},{default:k(()=>[s("div",_e,y(e.displayedYear),1)]),_:1}),c(o,{onClick:n[4]||(n[4]=a=>e.changeCalendar("plusYear"))},{icon:k(()=>[c(C)]),_:1})]),s("div",Le,[c(o,{onClick:n[5]||(n[5]=a=>e.changeCalendar("minusMonth")),disabled:e.selectedYear===1&&e.selectedMonth===1},{icon:k(()=>[c(w)]),_:1},8,["disabled"]),c(o,{onClick:n[6]||(n[6]=a=>e.changeCalendarType("month"))},{default:k(()=>[s("div",Se,y(e.displayedMonth),1)]),_:1}),c(o,{onClick:n[7]||(n[7]=a=>e.changeCalendar("plusMonth"))},{icon:k(()=>[c(C)]),_:1})])])):I("",!0),e.selectedType==="year"?(r(),u("div",Ue,[c(o,{disabled:e.yearRangeIndex===0,onClick:n[8]||(n[8]=a=>e.yearRangeIndex--)},{icon:k(()=>[c(w)]),_:1},8,["disabled"]),s("div",je,[(r(!0),u(x,null,F(e.years,(a,f)=>(r(),u(x,null,[a?(r(),u("div",{key:f,onClick:j=>e.canClick("year",a)?e.selectYear(a):void 0,class:B({selected:a===e.selectedYear&&e.canClick("year",a),"item whitespace-nowrap min-w-[70px]":!0,disabled:!e.canClick("year",a)})},y(a),11,Ne)):I("",!0)],64))),256))]),c(o,{disabled:e.yearRangeIndex===e.currentYearRangeIndex&&!e.needFuture,onClick:n[9]||(n[9]=a=>e.yearRangeIndex++)},{icon:k(()=>[c(C)]),_:1},8,["disabled"])])):I("",!0),e.selectedType==="month"?(r(),u("div",Pe,[(r(!0),u(x,null,F(e.months,(a,f)=>(r(),u("div",{key:f,onClick:j=>e.canClick("month",a.value)?e.selectMonth(a.value):void 0,class:B({selected:a.value===e.selectedMonth&&e.canClick("month",a.value),"item whitespace-nowrap min-w-[70px]":!0,disabled:!e.canClick("month",a.value)})},y(a.text),11,Ve))),128))])):I("",!0),s("div",null,[e.selectedType==="date"?(r(),u("div",Ze,[(r(!0),u(x,null,F(e.weekdays,a=>(r(),u("div",{key:a,class:"mb-4 text-center font-black"},y(a),1))),128)),(r(!0),u(x,null,F(e.firstDayOfMonth,a=>(r(),u("span",{key:"blank-"+a,class:"blank-date item"}))),128)),(r(!0),u(x,null,F(e.calendarDays,a=>(r(),u("div",{key:a,onClick:f=>e.canClick("date",a)?e.selectDate(a):void 0,class:B({selected:e.checkIsSelectedDate(a)&&e.canClick("date",a),item:!0,disabled:!e.canClick("date",a)})},y(a),11,Ae))),128))])):I("",!0)])])),[[M,e.closeCalendar]]):I("",!0)])],2)])}const U=R(Ye,[["render",Ee],["__scopeId","data-v-ef80b4b3"]]),Oe={class:"flex flex-wrap gap-y-6 max-w-lg"},qe={class:"w-full"},ze={class:"mt-2"},Ge={class:"text-xl"},He={class:"w-full"},Je={class:"mt-2"},Ke={class:"text-xl"},Qe={class:"w-full"},We={class:"mt-2"},Xe={class:"text-xl"},et={class:"w-full"},tt={class:"mt-2"},lt={class:"text-xl"},nt={class:"flex justify-center"},at={__name:"Index",setup(e){const n=p(null),g=p("2024/09/05"),m=p("100.01.01"),$=p("");return(d,l)=>(r(),u(x,null,[l[12]||(l[12]=s("div",{class:"text-center mb-4 font-bold text-xl"},"民國年日期選擇器 (CustomRocDatePicker)",-1)),s("div",Oe,[s("div",qe,[l[5]||(l[5]=s("div",null,"類型1: 無預設值(null) + readonly",-1)),s("div",ze,[l[4]||(l[4]=L("選擇日期(民國): ")),s("span",Ge,y(n.value),1)]),s("div",null,[c(U,{date:n.value,"onUpdate:date":l[0]||(l[0]=o=>n.value=o),readonly:""},null,8,["date"])])]),s("div",He,[l[7]||(l[7]=s("div",null,"類型2: 有預設值(西元) + 自動轉換格式(西元 轉 民國)",-1)),s("div",Je,[l[6]||(l[6]=L("選擇日期(西元): ")),s("span",Ke,y(g.value),1)]),c(U,{date:g.value,"onUpdate:date":l[1]||(l[1]=o=>g.value=o),"auto-to-roc-format":""},null,8,["date"])]),s("div",Qe,[l[9]||(l[9]=s("div",null,"類型3: 有預設值(民國) + 變更分隔為. + 需要選擇未來日期",-1)),s("div",We,[l[8]||(l[8]=L("選擇日期(民國): ")),s("span",Xe,y(m.value),1)]),c(U,{date:m.value,"onUpdate:date":l[2]||(l[2]=o=>m.value=o),placeholder:"民國年.月.日",splitter:".","need-future":""},null,8,["date"])]),s("div",et,[l[11]||(l[11]=s("div",null,"類型4: 無預設值('') + 只需要 icon button",-1)),s("div",tt,[l[10]||(l[10]=L("選擇日期(民國): ")),s("span",lt,y($.value),1)]),s("div",nt,[c(U,{date:$.value,"onUpdate:date":l[3]||(l[3]=o=>$.value=o),"need-input":!1},null,8,["date"])])])])],64))}},ot=R(at,[["__scopeId","data-v-727085fa"]]);export{ot as default};
